<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title></title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="game-container">
      <div class="cell-container">
        <div data-value="0" id="cell-0" class="cell empty-cell"></div>
        <div data-value="1" id="cell-1" class="cell empty-cell"></div>
        <div data-value="2" id="cell-2" class="cell empty-cell"></div>
        <div data-value="3" id="cell-3" class="cell empty-cell"></div>
        <div data-value="4" id="cell-4" class="cell empty-cell"></div>
        <div data-value="5" id="cell-5" class="cell empty-cell"></div>
        <div data-value="6" id="cell-6" class="cell empty-cell"></div>
        <div data-value="7" id="cell-7" class="cell empty-cell"></div>
        <div data-value="8" id="cell-8" class="cell empty-cell"></div>
      </div>
    </div>

    <script src="./main.js"></script>
    <script>
      let symbol = {
        0: "",
        1: "X",
        2: "O"
      };

      updateBoard = () => {
        let board = Module.get_gameboard();
        for (let i = 0; i < 9; i++) {
          let elem = document.querySelector(`#cell-${i}`);
          elem.innerHTML = symbol[board[i]];
          if (board[i] !== 0) {
            elem.classList.remove("empty-cell");
          }
        }
      };

      Module.onRuntimeInitialized = () => {
        // player move
        document.querySelectorAll(".empty-cell").forEach(input =>
          input.addEventListener("click", () => {
            Module.make_player_move(parseInt(input.getAttribute("data-value")));
            updateBoard();
          })
        );

        // update the board
        updateBoard();
      };
    </script>
  </body>
</html>
